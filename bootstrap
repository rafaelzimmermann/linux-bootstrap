#!/bin/bash

set -ex

source "$(dirname "$0")/lib/pkg.sh"

# Ask for sudo once and keep the credential alive for the duration of the script
sudo -v
while true; do sudo -v; sleep 50; done &
SUDO_KEEPALIVE=$!
trap "kill $SUDO_KEEPALIVE 2>/dev/null || true" EXIT

pkg_update

case "$OS" in
    arch)
        pkg_install vim htop tmux git python-pip ruby samba jq curl zsh inetutils
        bash install-yay
        bash config-nvidia
        bash config-hyprland
        ;;
    *)
        pkg_install vim htop tmux git python3-pip ruby-full samba jq curl zsh
        ;;
esac

chsh -s /bin/zsh

bash install-ohmyzsh
bash install-rust
bash config-python
bash config-tmux
bash install-java
bash install-nerdfonts
bash install-nvim

cp -r config/dotconfig/. "${HOME}/.config"
